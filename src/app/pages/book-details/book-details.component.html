<div class="min-h-screen bg-background">
  <main class="container mx-auto px-4 py-8">
    <a routerLink="/catalog" class="mb-6 inline-flex items-center text-sm text-muted-foreground hover:text-foreground">
      <lucide-icon name="arrow-left" class="mr-2 h-4 w-4"></lucide-icon>
      Back to Catalog
    </a>

    @if (isLoading()) {
      <div class="flex items-center justify-center py-12">
        <div class="h-8 w-8 animate-spin rounded-full border-2 border-primary border-t-transparent"></div>
      </div>
    } @else if (!book()) {
      <p class="text-center text-muted-foreground">Book not found</p>
    } @else {
      <div class="grid gap-8 md:grid-cols-3">
        <div class="rounded-lg border border-border bg-card p-6">
          <div class="mb-4 flex aspect-[3/4] items-center justify-center overflow-hidden rounded-lg bg-muted">
            @if (book()?.imageUrl) {
              <img [src]="book()?.imageUrl" [alt]="book()?.title + ' cover'" class="h-full w-full object-cover" />
            } @else {
              <lucide-icon name="book-open" class="h-24 w-24 text-muted-foreground"></lucide-icon>
            }
          </div>
          <div class="space-y-3">
            <div class="flex items-center justify-between text-sm font-medium">
              <span class="text-muted-foreground">Availability:</span>
              <span class="rounded-full px-3 py-1 text-xs font-semibold"
                [class.bg-success]="book()?.availableCopies! > 0"
                [class.text-success-foreground]="book()?.availableCopies! > 0"
                [class.bg-destructive/10]="book()?.availableCopies === 0"
                [class.text-destructive]="book()?.availableCopies === 0"
              >
                {{ book()?.availableCopies! > 0 ? 'Available' : 'Not Available' }}
              </span>
            </div>
            <div class="rounded-md bg-primary/5 p-3 text-center">
              <p class="text-2xl font-bold text-primary">{{ book()?.availableCopies }}</p>
              <p class="text-sm text-muted-foreground">of {{ book()?.totalCopies }} copies available</p>
            </div>
          </div>
        </div>

        <div class="md:col-span-2 space-y-6">
          <div>
            <span class="mb-2 inline-flex rounded-full bg-secondary px-3 py-1 text-xs font-semibold text-secondary-foreground">
              {{ book()?.category }}
            </span>
            <h1 class="text-4xl font-bold text-foreground">{{ book()?.title }}</h1>
            <p class="text-xl text-muted-foreground">by {{ book()?.author }}</p>
          </div>

          <div class="rounded-lg border border-border bg-card">
            <div class="border-b border-border px-6 py-4">
              <h2 class="text-lg font-semibold">Description</h2>
            </div>
            <div class="px-6 py-4 text-muted-foreground">
              {{ book()?.description }}
            </div>
          </div>

          <div class="rounded-lg border border-border bg-card">
            <div class="border-b border-border px-6 py-4">
              <h2 class="text-lg font-semibold">Book Information</h2>
            </div>
            <div class="space-y-3 px-6 py-4">
              <div class="flex items-center justify-between border-b border-border pb-2 text-sm">
                <span class="text-muted-foreground">ISBN</span>
                <span class="font-medium text-foreground">{{ book()?.ISBN }}</span>
              </div>
              <div class="flex items-center justify-between border-b border-border pb-2 text-sm">
                <span class="flex items-center gap-2 text-muted-foreground">
                  <lucide-icon name="calendar" class="h-4 w-4"></lucide-icon>
                  Publication Year
                </span>
                <span class="font-medium text-foreground">{{ book()?.publicationYear }}</span>
              </div>
              <div class="flex items-center justify-between border-b border-border pb-2 text-sm">
                <span class="text-muted-foreground">Category</span>
                <span class="font-medium text-foreground">{{ book()?.category }}</span>
              </div>
              <div class="flex items-center justify-between text-sm">
                <span class="flex items-center gap-2 text-muted-foreground">
                  <lucide-icon name="map-pin" class="h-4 w-4"></lucide-icon>
                  Shelf Location
                </span>
                <span class="font-medium text-foreground">{{ book()?.shelfLocation }}</span>
              </div>
            </div>
          </div>

          @if (book()?.availableCopies === 0) {
            <div class="rounded-lg border border-destructive/20 bg-destructive/10 p-4 text-sm text-foreground">
              This book is currently unavailable. Please check back later or visit the library desk for more information.
            </div>
          }
        </div>
      </div>
    }
  </main>
</div>
